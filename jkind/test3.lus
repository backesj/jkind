type Lst = induct {cons (head int) (tail Lst) | nil };
type LstTuple = induct {lstTuple (left Lst) (right Lst)};


recursive length(l : Lst) returns (r : int);
let
  r = if (is_nil l) then
        0
      else
        1 + (length (tail l));
tel;

recursive half_helper(l1 : Lst; l2 : Lst; l : Lst) returns (r : LstTuple);
let
  r = if (is_nil l) then
        (lstTuple l1 l2)
      else if (is_nil (tail l)) then
        (lstTuple (cons (head l) l1) l2)
      else
        (half_helper (cons (head l) l1) (cons (head (tail l)) l2) (tail (tail l)));
tel;

recursive half(l : Lst) returns (r : LstTuple);
let
  r = (half_helper nil nil l);
tel;

recursive merge(l1 : Lst; l2 : Lst) returns (r : Lst);
let
  r = if (is_nil l1) then
        l2
      else if (is_nil l2) then
        l1
      else if (head l1) < (head l2) then
         (cons (head l1) (merge (tail l1) l2)) 
      else
         (cons (head l2) (merge l1 (tail l2)));
tel;

recursive sorted(l : Lst) returns (r : bool);
let
  r = if (is_nil l) then
        true
      else if (is_nil (tail l)) then
        true
      else if (head l) > (head (tail l)) then
        false
      else
        (sorted (tail l));
tel;

recursive contains(l : Lst; x : int) returns (r : bool);
let
  r = if (is_nil l) then
        false
      else
        (head l) = x or (contains (tail l) x);
tel;

node main() returns ();
var
  prop0 : bool;
  prop1 : bool;
  prop2 : bool;
  prop3 : bool;
  prop4 : bool;
let                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
  prop0 = forall (l1 : Lst; l2 : Lst) .
    (sorted l1) and (sorted l2) => (sorted (merge l1 l2));
  
  prop1 = forall(x : int; l2 : Lst; l1 : Lst) .
    (contains l1 x) => (contains (left (half_helper l1 l2 nil)) x);
    
  prop2 = forall(x : int; y : int;  l : Lst; l2 : Lst; l1 : Lst) .
    (contains l1 x) => (contains (left (half_helper l1 l2 (cons y nil))) x);
    
  prop3 = forall(x : int; z : int; y : int; l : Lst; l2 : Lst; l1 : Lst) .
    (contains (left (half_helper (cons z l1) (cons y l2) l)) x) =>
    (contains (left (half_helper l1 l2 (cons z (cons y l)))) x);
        
  prop4 = forall(l: Lst; l1 : Lst; l2 : Lst; x : int; y : int; z : int) .
    (contains l1 x) => (contains (left (half_helper l1 l2 (cons y (cons x l)))) x);
  
    
  ----%PROPERTY prop0;
  --%PROPERTY prop1;
  --%PROPERTY prop2;
  --%PROPERTY prop3;
  --%PROPERTY prop4;
tel;
        
 